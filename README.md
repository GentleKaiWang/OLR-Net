# OLR-Net: Object Label Retrieval Network for principal diagnosis extraction

Code for the paper OLR-Net: Object Label Retrieval Network for principal diagnosis extraction. 

Extract principal diagnoses from Chinese discharge summary records with limited available data.


## Dependencies
- keras_bert==0.88.0

- numpy==1.19.5

- tensorflow==2.4.0

- [RoBERTa_zh_L12(tensorflow)](https://github.com/brightmart/roberta_zh?tab=readme-ov-file)

## Data
According to Article 22 (No. 20) of the “[Basic Standards for Medical Record Writing](http://www.nhc.gov.cn/wjw/gfxwj/201304/1917f257cd774afa835cff168dc4ea41.shtml)” issued by Ministry of Health (now National Health Commission) of Peoples’ Republic China in January 2010, the contents of Chinese discharge summary records mainly include admission date, discharge date, admission situation, admission diagnosis, treatment, discharge diagnosis, discharge situation, discharge advice, signature, and so on. 

The data format is ``` ".jsonl" ```. We provide one virtual example, ``` /data/test_data.jsonl ```, generated by GPT-4.0, which is only for testing and does not represent real data.

## Training new models
Training new models includes label retrieval and label localization. The pre-trained feature extractor in the label retrieval will be fine-tuned in the label localization. The data set is from the discharge summary records of the oncology department in Hainan Hospital of Chinese People's Liberation Army General Hospital. Because of the confidentiality of data, we don't provide real data to train new models.

- label retrieval. ``` python b_retrieval.py ```
- label localization. ``` python b_localization.py ```

## Prediction
The models weights are in ``` /model ```
- Top-5 principal diagnoses prediction. ``` python c_prediction.py ```


